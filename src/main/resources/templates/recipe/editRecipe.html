<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="de">
<head th:replace="fragments/style :: head"></head>
<body>
<div class="container">
  <nav th:insert="fragments/menu :: navbar"></nav>
  <div class="my-4">
    <div class="form-group row">
      <p class="h1">Create a Recipe</p>
    </div>
    <form th:action="${'/recipe/edit/' + recipe.id}" th:object="${recipeForm}" method="post">
      <div class="form-group row">
        <label class="col-form-label col-form-label-sm col-sm-2" for="title">Name of Recipe:</label>
        <div class="col-sm-10">
           <input class="form-control form-control-sm" type="text" id="title" th:field="*{title}" th:classappend="${#fields.hasErrors('title') ? 'is-invalid' : ''}">
          <span class="text-danger" th:errors="*{title}" />
        </div>
      </div>
      <div class="form-group row">
        <label class="col-form-label col-form-label-sm col-sm-2" for="description">Additional Information:</label>
        <div class="col-sm-10">
          <input class="form-control form-control-sm" type="text" id="description" th:field="*{description}" th:classappend="${#fields.hasErrors('description') ? 'is-invalid' : ''}">
          <span class="text-danger" th:errors="*{description}" />
        </div>
      </div>
      <div class="form-group row">
        <label class="col-form-label col-form-label-sm col-sm-2" for="servings">Portions:</label>
        <div class="col-sm-10">
          <input class="form-control form-control-sm" type="number" id="servings" name="servings" th:field="*{servings}" th:classappend="${#fields.hasErrors('servings') ? 'is-invalid' : ''}">
          <span class="text-danger" th:errors="*{servings}" />
        </div>
      </div>
      <div class="form-group row">
        <label class="col-form-label col-form-label-sm col-sm-2" for="instruction">Instruction:</label>
        <div class="col-sm-10">
          <textarea class="form-control form-control-sm" type="text" id="instruction" name="instruction" th:field="*{instruction}" th:classappend="${#fields.hasErrors('instruction') ? 'is-invalid' : ''}"> </textarea>
          <span class="text-danger" th:errors="*{instruction}" />
        </div>
      </div>
      <div class="form-group row">
        <label class="col-form-label col-form-label-sm col-sm-2" for="difficulty">Difficulty:</label>
        <div class="col-sm-10">
          <select class="form-control form-control-sm" id="difficulty" name="difficulty" th:field="*{difficulty}">
            <option th:each="difficulty : ${difficultyList}" th:value="${difficulty}" th:text="${difficulty}"></option>
          </select>
        </div>
      </div>
      <div class="form-group row">
        <label class="col-form-label col-form-label-sm col-sm-2" for="prepTime">Preparation Time:</label>
        <div class="col-sm-10">
          <input class="form-control form-control-sm" type="number" min="0" id="prepTime" name="prepTime" th:field="*{prepTime}" th:classappend="${#fields.hasErrors('prepTime') ? 'is-invalid' : ''}">
          <span class="text-danger" th:errors="*{prepTime}" />
        </div>
      </div>
      <div class="form-group row">
        <label class="col-form-label col-form-label-sm col-sm-2" for="cookTime">Cooking Time:</label>
        <div class="col-sm-10">
          <input class="form-control form-control-sm" type="number" id="cookTime" name="cookTime" th:field="*{cookTime}" th:classappend="${#fields.hasErrors('cookTime') ? 'is-invalid' : ''}">
          <span class="text-danger" th:errors="*{cookTime}" />
        </div>
      </div>
      <div class="form-group row">
        <label class="col-form-label col-form-label-sm col-sm-2" for="isPrivat">Private Recipe?</label>
        <div class="col-sm-10">
          <input class="form-control-sm" type="checkbox" id="isPrivat" name="isPrivat">
        </div>
      </div>
      <div class="form-group row">
        <div class="col-sm-10">
          <button class="btn btn-primary btn-sm" type="submit">Save Recipe</button>
        </div>
      </div>
    </form>
    <div class="form-group row">
        <p class="h2">Ingredients</p>
      </div>
      <table th:if="${recipe.ingredientEntries != null and recipe != null}" class="table">
        <tr>
          <th>Amount</th>
          <th>Unit of Measurement</th>
          <th>Name of Ingredient</th>
          <th></th>
        </tr>
        <tr th:each="ingredient : ${recipe.ingredientEntries}">
          <td th:text="${ingredient.amount}" name="amount" ></td>
          <td th:text="${ingredient.uom}" name="uom" ></td>
          <td th:text="${ingredient.name}" name="name" ></td>
          <th><a class="btn btn-primary btn-sm" th:href="${'/recipe/edit/' + recipe.id + '/deleteIngredient/' + ingredientStat.index}">Delete Ingredient</a></th>
        </tr>
        <tr>
          <form th:action="${'/recipe/edit/' + recipe.id + '/add-ingredient/'}" th:object="${ingredientForm}" method="post">
            <th><input class="form-control form-control-sm" type="number" id="amount" th:field="*{amount}" th:classappend="${#fields.hasErrors('amount') ? 'is-invalid' : ''}"><span class="text-danger" th:errors="*{amount}" /></th>
            <th><select class="form-control form-control-sm" id="uom" th:field="*{uom}">
              <option th:each="unitOfMeasure : ${unitOfMeasureList}" th:text="${unitOfMeasure}" th:value="${unitOfMeasure}"></option>
            </select></th>
            <th><input class="form-control form-control-sm" type="text" id="name" th:field="*{name}" th:classappend="${#fields.hasErrors('name') ? 'is-invalid' : ''}"><span class="text-danger" th:errors="*{name}" /></th>
            <th><button class="btn btn-primary btn-sm" type="submit" name="action" value="addIngredient">Add Ingredient</button></th>
          </form>
        </tr>
      </table>
    <div class="form-group row">
      <form th:action="${'/recipe/edit/' + recipe.id + '/deleteRecipe/'}" method="post" class="form">
        <button type="submit" class="btn btn-danger">Delete Recipe</button>
      </form>
    </div>
  </div>
</div>
</body>
</html>